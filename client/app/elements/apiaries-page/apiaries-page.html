<dom-module id="apiaries-page">
  <link rel="stylesheet" href="apiaries-page.css">

  <template>
    <iron-list id="list" items="[[data]]" as="item" scrollTarget="{{scrollTarget}}">
      <template>
        <apiary-list-item>
          <span class="count">{{item.count}}</span>
          <span class="name">{{item.name}}</span>
          <span class="location">{{item.location}}</span>
        </apiary-list-item>
      </template>
    </iron-list>
  </template>
</dom-module>

<script>
  (function () {
    Polymer({
      is: 'apiaries-page',

      properties: {
        token: String,
        scrollTarget: Object
      },

      ready: function () {
        this.$.list.items = [
          { count: 2, name: "Bee Yard", location: 'Somewhere, IL' },
          { count: 21, name: 'Another Bee Yard', location: 'Chicago, IL' },
          { count: 1, name: 'Marvy Apiary', location: 'Bensenville, IL' },
        ];
      },

      getApiaryPath: function (id) {
        return 'apiaries/' + id;
      },

      loadData: function (event) {
        var client = this.$.client;

        var headers = {
          'Authorization': 'Token token=' + this.token,
          'Accept': 'application/json'
        };
        client.headers = headers;
        client.contentType = 'application/json';
        client.generateRequest();
      },

      handleResponse: function (event) {
        console.log(event.detail.response);
        this.apiaries = event.detail.response;
      },

      handleError: function (event) {
        console.log(event.detail);
      }
    });
  })();
</script>
